% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={A Quick Introduction to MF.beta4 via Examples},
  pdfauthor={Anne Chao, Chun-Yu Liu},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{A Quick Introduction to MF.beta4 via Examples}
\author{Anne Chao, Chun-Yu Liu}
\date{2023-10-20}

\begin{document}
\maketitle

\texttt{MF.beta4} is a R package for measuring ecosystem
multifunctionality and assessing BEF relationships. It was originally
developed for the Beta4 project (MÃ¼ller et al.~2022) on the effect of
enhancing the beta diversity between forest patches on ecosystem
multifunctionality and forest resilience across spatial scales.

Based on a framework of Hill-Chao numbers of orders q = 0, 1 and 2,
\texttt{MF.beta4} features the following multifunctionality measures for
a single and multiple ecosystems; see Chao et al.~(2023) for pertinent
methodology and decomposition theory.

\begin{enumerate}
\def\labelenumi{(\arabic{enumi})}
\tightlist
\item
  Multifunctionality measures in a single ecosystem
\end{enumerate}

\texttt{MF.beta4} computes a class of weighted multifunctionality
measures for given function weights. Multifunctionality measures that
correct for strong correlations between ecosystem functions to avoid
redundancy are also provided.

\begin{enumerate}
\def\labelenumi{(\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  Multifunctionality measures in multiple ecosystems
\end{enumerate}

\texttt{MF.beta4} computes gamma multifunctionality of pooled
ecosystems, within-ecosystem component (alpha multifunctionality) and
among-ecosystem component (beta multifunctionality).

Based on biodiversity and function data from ecosystems, this package
also facilitates graphics for assessing the biodiversity-ecosystem
functioning (BEF) relationships across scales by \texttt{ggMF}.

\hypertarget{how-to-cite}{%
\subsection{How to cite}\label{how-to-cite}}

If you publish your work based on results from \texttt{MF.beta4}
package, you should make references to the following methodology paper
and Online software:

Chao, A., Chiu, C. H., Hu, K. H., van der Plas, F., Cadotte, M. W.,
Mitesser, O., et al.~(2023). Hill-Chao numbers in multifunctionality
allows decomposing gamma multifunctionality into alpha and beta
components. Under revision, Ecology Letters.

Chao, A. and Hu, K.-H. (2023) MF.beta4: Software for measuring ecosystem
multifunctionality and assessing BEF relationships. . Code and User's
guide available from
http://chao.stat.nthu.edu.tw/wordpress/software\_download/MF-beta4/

\hypertarget{software-needed-to-run-mf.beta4-in-r}{%
\subsection{SOFTWARE NEEDED TO RUN MF.beta4 IN
R}\label{software-needed-to-run-mf.beta4-in-r}}

\begin{itemize}
\tightlist
\item
  Required: \href{https://cran.r-project.org/}{R}
\item
  Suggested:
  \href{https://www.rstudio.com/products/RStudio/\#Desktop}{RStudio IDE}
\end{itemize}

\hypertarget{how-to-run-mf.beta4}{%
\subsection{HOW TO RUN MF.beta4:}\label{how-to-run-mf.beta4}}

The \texttt{MF.beta4} package can be downloaded from Anne Chao's
\href{https://github.com/AnneChao/MF.beta4}{MF.beta4\_github} using the
following commands. For a first-time installation, an additional
visualization extension package (\texttt{ggplot2}) must be installed and
loaded.

\begin{Shaded}
\begin{Highlighting}[]
\DocumentationTok{\#\# install MF.beta4 package from CRAN}
\CommentTok{\# install.packages("MF.beta4")  \# coming soon}

\DocumentationTok{\#\# install the latest version from github}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{\textquotesingle{}devtools\textquotesingle{}}\NormalTok{)}
\FunctionTok{library}\NormalTok{(devtools)}
\FunctionTok{install\_github}\NormalTok{(}\StringTok{"AnneChao/MF.beta4"}\NormalTok{)}

\DocumentationTok{\#\# import packages}
\FunctionTok{library}\NormalTok{(MF.beta4)}
\end{Highlighting}
\end{Shaded}

Here are four main functions we provide in this package :

\begin{itemize}
\tightlist
\item
  \textbf{func\_normalized} : Normalizing ecosystem functions data and
  turn all values between 0 and 1.
\item
  \textbf{MF\_single} : Computing quantification of multifuctionality
  measures in a single ecosystem when all functions are assumed to be
  independent, and when the correlation between any two functions is
  adjusted for. In the latter case, our MF value is obtained based on an
  integrated measure by considering all possible threshold levels.
\item
  \textbf{MF\_multiple} : Computing decomposition of multifuctionality
  measures in multiple ecosystems when all functions are assumed to be
  independent, and when the correlation between any two functions is
  adjusted for. In the latter case, our MF value is obtained based on an
  integrated measure by considering all possible threshold levels.
\item
  \textbf{ggMF} : Visualizing the output from the function
  \texttt{MF\_single} or \texttt{MF\_multiple}.
\end{itemize}

\hypertarget{normalized-the-raw-data-func_normalized}{%
\subsection{Normalized the raw data:
func\_normalized()}\label{normalized-the-raw-data-func_normalized}}

We first describe the normalized function \texttt{func\_normalized()}
with default arguments, and the arguments of this function are briefly
described below.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{func\_normalized}\NormalTok{(data, }\AttributeTok{fun\_cols =} \DecValTok{1}\SpecialCharTok{:}\FunctionTok{ncol}\NormalTok{(data), }\AttributeTok{negative =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{by\_group =} \ConstantTok{NULL}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

Argument

Description

data

Data can be input as a matrix/data.frame (assemblages by functions).
Data should be without NA, if does, the missing values need to impute
first and then use the function.

fun\_cols

The order number of the columns which be used as the ecosystem function.

negative

Name of columns which need to be normalized negatively.

by\_group

Name of the column to be normalized by group. Default is NULL.

This function returns a data.frame with normalized functions.

\hypertarget{multifunctionality-mf_single}{%
\subsection{Multifunctionality:
MF\_single()}\label{multifunctionality-mf_single}}

One of the main function to measure MF is \texttt{MF\_single()}, and the
following is default arguments of the function:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{MF\_single}\NormalTok{(func\_data, }\AttributeTok{species\_data =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{q =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

The arguments of this function are briefly described below, and will be
explained in more details by illustrative examples in later text. This
main function computes quantification multi-fuctionality of order q in a
single ecosystem when all functions are assumed to be independent and
when the correlation is considered.

Argument

Description

func\_data

The ecosystem function data can be input as a vector of functions (for a
single assemblage), matrix/data.frame (assemblages by functions). The
data input must be normalized between 0 and 1 already and must contain
only the ecosystem function columns. For species\_data is not NULL, the
rownames of func\_data should be names of `plotID'.

species\_data

The species abundance data must include three columns: `plotID',
`species' and `abundance'. Default is NULL.

q

A numerical vector specifying the diversity orders. Default is 0, 1 and
2.

\hypertarget{multifunctionality-mf_multiple}{%
\subsection{Multifunctionality:
MF\_multiple()}\label{multifunctionality-mf_multiple}}

The other main function to measure MF is \texttt{MF\_multiple()}, and
the following is default arguments of the function:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{MF\_multiple}\NormalTok{(func\_data, }\AttributeTok{species\_data =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{q =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{), }\AttributeTok{by\_group =} \ConstantTok{NULL}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

The arguments of this function are briefly described below, and will be
explained in more details by illustrative examples in later text. This
main function computes decomposition multi-fuctionality of order q in
multiple ecosystems when all functions are assumed to be independent and
when the correlation is considered.

Argument

Description

func\_data

The ecosystem function data can be input as a vector of functions (for a
single assemblage), matrix/data.frame (assemblages by functions). The
data input must be normalized between 0 and 1 already. For by\_group =
NULL the func\_data must contain only the ecosystem function columns.
Otherwise, you must add the by\_group column in data. For species\_data
is not NULL, the rownames of func\_data should be names of `plotID'.

species\_data

The species abundance data must include three columns: `plotID',
`species' and `abundance'. Default is NULL.

q

A numerical vector specifying the diversity orders. Default is 0, 1 and
2.

by\_group

Name of the column to be paired by group. Default is NULL.

The above two functions (\texttt{MF\_single()} and
\texttt{MF\_multiple()}) returns a data.frame which can be further used
to make plots using the function \texttt{ggMF()} to be described below.

\hypertarget{data-input-format}{%
\subsection{Data input format}\label{data-input-format}}

\hypertarget{ecosystem-functions-data}{%
\paragraph{Ecosystem functions data}\label{ecosystem-functions-data}}

The input data for L ecosystem functions should be arranged as a
matrix/data.frame with ecosystems/plots in rows, and ecosystem function
values in columns; here each plot is designated as an ecosystem. The
first row starting from column B lists the names for the L functions;
see an example below. Beginning with the second row, the first entry for
column A in each row denotes plot id or plot label, followed by L
function values.

A forest tree species and ecosystem function data is included in
\texttt{MF.beta4} package for illustration. see Baeten et al.~(2013),
van der Plas et al.~(2016) and Ratcliffe et al.~(2017) for a detailed
description. In the data, a total of 209 plots (each with 30 m x 30 m)
were established in mature forests in six countries, representing six
major European forest types. In each country, three to five common tree
species were selected for the species pool; each of the 209 plots
consisted of one to five tree species. The basal area of each tree
species within each plot was used as a proxy for species abundance.
Within each country, there are 28 to 43 plots, where each plot is
designated as an ecosystem. In each plot, a total of 26 ecosystem
functions or properties were measured; see Appendix S3 of Chao et
al.~(2023) for a list of the 26 functions (with brief description) and
their pairwise correlations.

Run the following code to view raw forest data: (Here we only show the
first ten rows of the first two ecosystem functions)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(}\StringTok{"Europe\_Forest\_raw"}\NormalTok{)}
\NormalTok{GER\_ITA\_Forest\_raw }\OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(Europe\_Forest\_raw,Country}\SpecialCharTok{==}\StringTok{"GER"}\SpecialCharTok{|}\NormalTok{Country}\SpecialCharTok{==}\StringTok{"ITA"}\NormalTok{)}
\NormalTok{GER\_ITA\_Forest\_raw}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
#>       plotid target_species_richness    composition earthworm_biomass fine_woody_debris
#> GER01  GER01                       1           Fasy             3.760                95
#> GER02  GER02                       1           Fasy             2.877                59
#> GER03  GER03                       2      Acps.Frex             9.803                72
#> GER04  GER04                       1           Frex            21.233               133
#> GER05  GER05                       1           Qupe            17.198                93
#> GER06  GER06                       2      Fasy.Qupe             6.125               167
#> GER07  GER07                       1           Piab             6.200                28
#> GER08  GER08                       1           Piab            11.734                87
#> GER09  GER09                       3 Acps.Fasy.Frex            17.103               114
#> GER10  GER10                       3 Acps.Fasy.Frex             5.265               114
\end{verbatim}

Since the data is not normalized, we then use
\texttt{func\_normalized()} to do normalization. Note that, in this
data, the ecosystem functions are column 4 to column 29. And there are
two ecosystem functions should be normalized negatively:
\texttt{"soil\_cn\_ff\_10"} and \texttt{"wue"}. Furthermore, the
performance of the ecosystem functions are quite different between six
countries, thus, we do normalization and analysis among each countries.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(}\StringTok{"Europe\_Forest\_raw"}\NormalTok{)}
\FunctionTok{func\_normalized}\NormalTok{(}\AttributeTok{data =}\NormalTok{ GER\_ITA\_Forest\_raw, }\AttributeTok{fun\_cols =} \DecValTok{4}\SpecialCharTok{:}\DecValTok{29}\NormalTok{,}
                \AttributeTok{negative =} \FunctionTok{c}\NormalTok{(}\StringTok{"soil\_cn\_ff\_10"}\NormalTok{,}\StringTok{"wue"}\NormalTok{), }\AttributeTok{by\_group =} \StringTok{"Country"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
#>       plotid target_species_richness    composition earthworm_biomass fine_woody_debris
#> GER01  GER01                       1           Fasy             0.057             0.318
#> GER02  GER02                       1           Fasy             0.042             0.147
#> GER03  GER03                       2      Acps.Frex             0.162             0.209
#> GER04  GER04                       1           Frex             0.360             0.498
#> GER05  GER05                       1           Qupe             0.290             0.308
#> GER06  GER06                       2      Fasy.Qupe             0.098             0.659
#> GER07  GER07                       1           Piab             0.100             0.000
#> GER08  GER08                       1           Piab             0.196             0.280
#> GER09  GER09                       3 Acps.Fasy.Frex             0.289             0.408
#> GER10  GER10                       3 Acps.Fasy.Frex             0.083             0.408
\end{verbatim}

This normalized data is same as the data \texttt{Europe\_Forest} in
\texttt{MF.beta4} package .

\hypertarget{species-abundance-data}{%
\paragraph{Species abundance data}\label{species-abundance-data}}

The input data include three columns: the ``plotID'' column includes the
name of ecosystems/plots, the species'' column includes species names,
and the ``abundance'' column includes the corresponding species
abundance.

Run the following code to view complete species abundance data:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(}\StringTok{"Europe\_Forest\_species"}\NormalTok{)}
\NormalTok{GER\_ITA\_Forest\_species}\OtherTok{\textless{}{-}}\NormalTok{Europe\_Forest\_species[}\DecValTok{49}\SpecialCharTok{:}\DecValTok{229}\NormalTok{,]}
\NormalTok{GER\_ITA\_Forest\_species}
\end{Highlighting}
\end{Shaded}

Here, we only show the first ten rows.

\begin{verbatim}
#> # A tibble: 10 x 3
#> # Groups:   plotID [8]
#>    plotID species             abundance
#>    <chr>  <chr>                   <dbl>
#>  1 GER01  Fagus.sylvatica         2.75 
#>  2 GER02  Fagus.sylvatica         2.56 
#>  3 GER03  Acer.pseudoplatanus     0.353
#>  4 GER03  Fraxinus.excelsior      2.90 
#>  5 GER04  Fraxinus.excelsior      3.67 
#>  6 GER05  Quercus.petraea         3.42 
#>  7 GER06  Fagus.sylvatica         1.07 
#>  8 GER06  Quercus.petraea         3.86 
#>  9 GER07  Picea.abies             2.35 
#> 10 GER08  Picea.abies             3.55
\end{verbatim}

\hypertarget{computing-multifunctionality-in-single-ecosystem-via-example}{%
\subsubsection{Computing Multifunctionality in Single Ecosystem Via
Example}\label{computing-multifunctionality-in-single-ecosystem-via-example}}

\hypertarget{if-the-species_data-is-not-provided}{%
\paragraph{\texorpdfstring{If the \texttt{species\_data} is not
provided}{If the species\_data is not provided}}\label{if-the-species_data-is-not-provided}}

For example, given a normalized data, we run the \texttt{MF\_single()}
function without setting \texttt{species\_data} to compute uncorrected
for correlations and corrected for correlations multifunctionality.
(Here we only show the first six outputs)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(}\StringTok{"Europe\_Forest"}\NormalTok{)}
\NormalTok{GER\_ITA\_Forest }\OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(Europe\_Forest,Country}\SpecialCharTok{==}\StringTok{"GER"}\SpecialCharTok{|}\NormalTok{Country}\SpecialCharTok{==}\StringTok{"ITA"}\NormalTok{)}
\NormalTok{output1 }\OtherTok{\textless{}{-}} \FunctionTok{MF\_single}\NormalTok{(}\AttributeTok{func\_data =}\NormalTok{ GER\_ITA\_Forest[,}\DecValTok{4}\SpecialCharTok{:}\DecValTok{29}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
#> # A tibble: 6 x 4
#>   plotID Type                         Order.q   qMF
#>   <chr>  <chr>                        <fct>   <dbl>
#> 1 GER01  Uncorrected_for_correlations q = 0    9.43
#> 2 GER01  Uncorrected_for_correlations q = 1    8.02
#> 3 GER01  Uncorrected_for_correlations q = 2    7.33
#> 4 GER01  Corrected_for_correlations   q = 0    8.94
#> 5 GER01  Corrected_for_correlations   q = 1    7.72
#> 6 GER01  Corrected_for_correlations   q = 2    7.10
\end{verbatim}

The output contains ID of plot (\texttt{plotID}) which is according to
the row names of the input data, \texttt{Type} (uncorrected for
correlations or corrected for correlations), the diversity order
(\texttt{Order.q}) and multifunctionality (\texttt{qMF}).

\hypertarget{if-there-is-species_data-given-to-function-mf_single}{%
\paragraph{\texorpdfstring{If there is \texttt{species\_data} given to
function
\texttt{MF\_single}}{If there is species\_data given to function MF\_single}}\label{if-there-is-species_data-given-to-function-mf_single}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(}\StringTok{"Europe\_Forest"}\NormalTok{)}
\FunctionTok{data}\NormalTok{(}\StringTok{"Europe\_Forest\_species"}\NormalTok{)}
\NormalTok{GER\_ITA\_Forest }\OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(Europe\_Forest,Country}\SpecialCharTok{==}\StringTok{"GER"}\SpecialCharTok{|}\NormalTok{Country}\SpecialCharTok{==}\StringTok{"ITA"}\NormalTok{)}
\NormalTok{GER\_ITA\_Forest\_species}\OtherTok{\textless{}{-}}\NormalTok{Europe\_Forest\_species[}\DecValTok{49}\SpecialCharTok{:}\DecValTok{229}\NormalTok{,]}
\NormalTok{output2 }\OtherTok{\textless{}{-}} \FunctionTok{MF\_single}\NormalTok{(}\AttributeTok{func\_data =}\NormalTok{ GER\_ITA\_Forest[,}\DecValTok{4}\SpecialCharTok{:}\DecValTok{29}\NormalTok{],}\AttributeTok{species\_data =}\NormalTok{ GER\_ITA\_Forest\_species)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
#>    plotID                         Type Order.q    qMF Species.diversity
#> 13  GER03 Uncorrected_for_correlations   q = 0 10.763              2.00
#> 14  GER03 Uncorrected_for_correlations   q = 1  9.811              1.41
#> 15  GER03 Uncorrected_for_correlations   q = 2  9.235              1.24
#> 16  GER03   Corrected_for_correlations   q = 0 10.133              2.00
#> 17  GER03   Corrected_for_correlations   q = 1  9.263              1.41
#> 18  GER03   Corrected_for_correlations   q = 2  8.718              1.24
\end{verbatim}

The output has only more one column \texttt{Species.diversity} than the
previous one.

\hypertarget{computing-decomposition-of-multifunctionality-in-multiple-ecosystems-via-example}{%
\subsubsection{Computing Decomposition of Multifunctionality In Multiple
Ecosystems Via
Example}\label{computing-decomposition-of-multifunctionality-in-multiple-ecosystems-via-example}}

For example, we run the \texttt{MF\_multiple()} function with forest
data to compute uncorrected for correlations and corrected for
correlations multifunctionality relationships across spatial scales.
(Here we only show the first six outputs)

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(}\StringTok{"Europe\_Forest"}\NormalTok{)}
\FunctionTok{data}\NormalTok{(}\StringTok{"Europe\_Forest\_species"}\NormalTok{)}
\NormalTok{GER\_ITA\_Forest }\OtherTok{\textless{}{-}} \FunctionTok{filter}\NormalTok{(Europe\_Forest,Country}\SpecialCharTok{==}\StringTok{"GER"}\SpecialCharTok{|}\NormalTok{Country}\SpecialCharTok{==}\StringTok{"ITA"}\NormalTok{)}
\NormalTok{GER\_ITA\_Forest\_species}\OtherTok{\textless{}{-}}\NormalTok{Europe\_Forest\_species[}\DecValTok{49}\SpecialCharTok{:}\DecValTok{229}\NormalTok{,]}
\NormalTok{output3 }\OtherTok{=} \FunctionTok{MF\_multiple}\NormalTok{(}\AttributeTok{func\_data =}\NormalTok{ GER\_ITA\_Forest[,}\DecValTok{4}\SpecialCharTok{:}\DecValTok{30}\NormalTok{],}
                      \AttributeTok{species\_data =}\NormalTok{ GER\_ITA\_Forest\_species,}
                      \AttributeTok{by\_group =} \StringTok{"Country"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
#> # A tibble: 6 x 7
#> # Groups:   plotID, Country, Type, Scale [2]
#>   plotID           Country Type                         Scale Order.q   qMF Species.diversity
#>   <chr>            <chr>   <fct>                        <fct> <chr>   <dbl>             <dbl>
#> 1 GER01 v.s. GER02 GER     Uncorrected_for_correlations Gamma q = 0    9.26             1    
#> 2 GER01 v.s. GER02 GER     Uncorrected_for_correlations Gamma q = 1    7.95             1    
#> 3 GER01 v.s. GER02 GER     Uncorrected_for_correlations Gamma q = 2    7.33             1    
#> 4 GER01 v.s. GER02 GER     Uncorrected_for_correlations Alpha q = 0    9.26             1    
#> 5 GER01 v.s. GER02 GER     Uncorrected_for_correlations Alpha q = 1    7.84             0.999
#> 6 GER01 v.s. GER02 GER     Uncorrected_for_correlations Alpha q = 2    7.21             0.999
\end{verbatim}

Each row of the output represents the decomposition of species diversity
and multifunctionality across two plots. The output contains ID
(\texttt{plotID}) which is according to the row names of the input data,
\texttt{Country} of two plots, \texttt{Type} (uncorrected for
correlations or corrected for correlations), \texttt{Scale} (gamma,
alpha or beta), the diversity order (\texttt{Order.q}),
multifunctionality (\texttt{qMF}) and decomposition of species
diversity(\texttt{Species.diversity}).

For \texttt{species\_data} is not provided, the column of decomposition
of species diversity are not included in the output.

\hypertarget{graphic-display-function-ggmf}{%
\subsection{Graphic Display: Function
ggMF()}\label{graphic-display-function-ggmf}}

The function \texttt{ggMF()}, which extends \texttt{ggplot2} to the
\texttt{"MF"} output object with default arguments, is described as
follows:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggMF}\NormalTok{(output, }\AttributeTok{by\_group =} \ConstantTok{NULL}\NormalTok{, }\AttributeTok{facets\_scale =} \StringTok{"fixed"}\NormalTok{, }
                 \AttributeTok{fit =} \StringTok{"LMM.intercept"}\NormalTok{, }\AttributeTok{text =} \StringTok{"Slope"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Argument

Description

output

The output from MF\_single or MF\_multiple.

by\_group

Whether the MF object to classify by group or not. If does, input name
of the column used for grouping. Default is NULL. For fit is selected to
be linear mixed model, you must offer the by\_group argument.

facets\_scale

Are scales shared across all facets (the default, ``fixed''), or do they
vary across rows (``free\_x''), columns (``free\_y''), or both rows and
columns (``free'')?

fit

Method of the fitted line. Select fit = ``lm'' for the linear model, or
fit = ``LMM.intercept'', fit = ``LMM.slope'' and fit = ``LMM.both'' for
the linear mixed model with random effect `intercept', `slope' and `both
intercept and slope', respectively.Default is fit = ``LMM.intercept''.

text

type of text information show in the plots. Select text = ``Slope'' to
see estimated of slopes, or text = ``R.squared'' to see model
performance. Default is text = ``Slope''.

The \texttt{ggMF()} function is a wrapper around the \texttt{ggplot2}
package to display the relationship between species diversity and
multifunctionality when output is from MF\_single, or to display the
relationship between the decomposition of species diversity and
multifunctionality (MF alpha vs.~species alpha, MF beta vs.~species
beta, and MF gamma vs.~species gamma) when output is from MF\_multiple
using a single line of code. The resulting object is of class
\texttt{"ggplot"} or \texttt{"list"} containing two lists of
\texttt{ggplot} objects, so it can be manipulated using the
\texttt{ggplot2} tools. Users can visualize the output with different
methods of the fitted line by setting the parameter \textbf{fit}

We first display multifunctionality in single ecosystem without
\texttt{by\_group} and with \texttt{by\_group}.

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggMF}\NormalTok{(output2, }\AttributeTok{facets\_scale =} \StringTok{\textquotesingle{}fixed\textquotesingle{}}\NormalTok{, }\AttributeTok{fit =} \StringTok{"lm"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=468px]{introduction_files/figure-latex/unnamed-chunk-19-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{output2 }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\StringTok{"plotID"}\OtherTok{=}\FunctionTok{rownames}\NormalTok{(GER\_ITA\_Forest),}
                      \StringTok{"Country"}\OtherTok{=}\NormalTok{GER\_ITA\_Forest}\SpecialCharTok{$}\NormalTok{Country) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{left\_join}\NormalTok{(output2,.,}\AttributeTok{by=}\StringTok{"plotID"}\NormalTok{)}
\FunctionTok{ggMF}\NormalTok{(output2, }\AttributeTok{by\_group =} \StringTok{"Country"}\NormalTok{, }\AttributeTok{facets\_scale =} \StringTok{\textquotesingle{}fixed\textquotesingle{}}\NormalTok{, }
     \AttributeTok{fit =} \StringTok{"LMM.intercept"}\NormalTok{)  }
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=468px]{introduction_files/figure-latex/unnamed-chunk-20-1} \end{center}

Without \texttt{by\_group}, we can only fit linear model, and for the
example with \texttt{by\_group}, we fit linear mixed model with random
effect `intercept' of fitted line.

And then, display decomposition of multifunctionality in multiple
ecosystems with linear model fitted line and linear mixed model with
random effect `intercept' fitted line.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{figure\_lm }\OtherTok{\textless{}{-}} \FunctionTok{ggMF}\NormalTok{(output3, }\AttributeTok{by\_group =} \StringTok{"Country"}\NormalTok{, }\AttributeTok{facets\_scale =} \StringTok{\textquotesingle{}fixed\textquotesingle{}}\NormalTok{, }\AttributeTok{fit =} \StringTok{"lm"}\NormalTok{)}
\NormalTok{figure\_LMM }\OtherTok{\textless{}{-}} \FunctionTok{ggMF}\NormalTok{(output3, }\AttributeTok{by\_group =} \StringTok{"Country"}\NormalTok{, }\AttributeTok{facets\_scale =} \StringTok{\textquotesingle{}fixed\textquotesingle{}}\NormalTok{, }\AttributeTok{fit =} \StringTok{"LMM.intercept"}\NormalTok{,}\AttributeTok{text =} \StringTok{"R.squared"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{figure\_lm}\SpecialCharTok{$}\NormalTok{Uncorrected\_for\_correlations}\SpecialCharTok{$}\NormalTok{ALL}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=446.4px]{introduction_files/figure-latex/unnamed-chunk-22-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{figure\_LMM}\SpecialCharTok{$}\NormalTok{Uncorrected\_for\_correlations}\SpecialCharTok{$}\NormalTok{ALL}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=446.4px]{introduction_files/figure-latex/unnamed-chunk-22-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{figure\_LMM}\SpecialCharTok{$}\NormalTok{Corrected\_for\_correlations}\SpecialCharTok{$}\NormalTok{ALL}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=446.4px]{introduction_files/figure-latex/unnamed-chunk-23-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{figure\_LMM}\SpecialCharTok{$}\NormalTok{Corrected\_for\_correlations}\SpecialCharTok{$}\NormalTok{Gamma}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=446.4px]{introduction_files/figure-latex/unnamed-chunk-24-1} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{figure\_LMM}\SpecialCharTok{$}\NormalTok{Corrected\_for\_correlations}\SpecialCharTok{$}\NormalTok{Alpha}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=446.4px]{introduction_files/figure-latex/unnamed-chunk-24-2} \end{center}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{figure\_LMM}\SpecialCharTok{$}\NormalTok{Corrected\_for\_correlations}\SpecialCharTok{$}\NormalTok{Beta}
\end{Highlighting}
\end{Shaded}

\begin{center}\includegraphics[width=446.4px]{introduction_files/figure-latex/unnamed-chunk-24-3} \end{center}

\end{document}
